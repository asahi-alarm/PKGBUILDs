# Maintainer: Jos Dehaes <jos.dehaes@gmail.com>
# Maintainer: Matthias Kurz <m.kurz@irregular.at>

pkgname=steam
pkgver=20241231
pkgrel=4
pkgdesc="Steam wrapper for Asahi ALARM: This package provides a wrapper to download, install and run Steam."
arch=('any')
license=('MIT')
depends=(
    'bash'
    #'dbus-x11' # todo, seems we don't need that as it does not exist (anymore) in arch
    'FEX-Emu'
    'grep'
    'hicolor-icon-theme'
    'lsb-release'
    'muvm>=0.2'
    'python'
    'xorg-xwininfo'
    'fex-emu-rootfs-arch'
    'mesa-fex-emu-overlay-i386'
    'mesa-fex-emu-overlay-x86_64'
    'virglrenderer'
    'zenity'
    'python-pyqt6'
    'python-pexpect'
    'python-requests'
    'python-pyxdg'
)
makedepends=(
    'coreutils'
    'desktop-file-utils'
    'appstream-glib'
)
source=(
    "shim.py"
    "LICENSE"
    "steam.desktop"
    "steam.svg"
    #"io.pagure.fedora_asahi.steam.metainfo.xml"
)
sha256sums=('6ec1caf759c685d86a90b420949db6f0e18c9f00725707fc580ef6dcd507454a'
            'a0621636424948ba47b5ea5760bcfa8ccf52a9e4e3284860befd58a6a0dbbf9e'
            'd6a8dded63f5893ef63dc533014fc4a7227a3ae13de99f5e02beffc4bd1b5c37'
            '4d4831c86034f4bba860f6835118ac3518d750db172a5f37055671fe2470d083')

package() {
    install -Dm0755 "$srcdir/shim.py" "$pkgdir/usr/bin/steam"
    install -Dm0644 "$srcdir/steam.desktop" "$pkgdir/usr/share/applications/steam.desktop"
    install -Dm0644 "$srcdir/steam.svg" "$pkgdir/usr/share/icons/hicolor/scalable/apps/steam.svg"
    #install -Dm0644 "$srcdir/io.pagure.fedora_asahi.steam.metainfo.xml" "$pkgdir/usr/share/metainfo/io.pagure.fedora_asahi.steam.metainfo.xml"
    install -Dm0644 "$srcdir/LICENSE" "$pkgdir/usr/share/licenses/$pkgname/LICENSE"
}

# TODO
#check() {
#    appstream-util validate-relax --nonet "$pkgdir/usr/share/metainfo/io.pagure.fedora_asahi.steam.metainfo.xml"
#}
